{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/Services/player-control/media.service\";\nimport * as i2 from \"@angular/common\";\nconst _c0 = [\"audioPlayer\"];\nfunction PlayerControlsComponent_div_3_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    const _r0 = i0.ɵɵreference(1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.formatTime(_r0.nativeElement.duration), \" \");\n  }\n}\nfunction PlayerControlsComponent_div_3_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"0:00\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PlayerControlsComponent_div_3_h3_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r5.selectedSong == null ? null : ctx_r5.selectedSong.songTitle, \" - \", ctx_r5.selectedSong == null ? null : ctx_r5.selectedSong.album == null ? null : ctx_r5.selectedSong.album.artist == null ? null : ctx_r5.selectedSong.album.artist.artistName, \" \");\n  }\n}\nfunction PlayerControlsComponent_div_3_h3_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r6.selectedSong == null ? null : ctx_r6.selectedSong.title, \" - \", ctx_r6.selectedSong == null ? null : ctx_r6.selectedSong.artist == null ? null : ctx_r6.selectedSong.artist.artistName, \" \");\n  }\n}\nfunction PlayerControlsComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"div\", 4)(2, \"div\", 5)(3, \"div\");\n    i0.ɵɵelement(4, \"img\", 6);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(5, \"div\", 7)(6, \"div\", 8)(7, \"div\", 9);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"input\", 10);\n    i0.ɵɵlistener(\"input\", function PlayerControlsComponent_div_3_Template_input_input_9_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.handleProgressBar($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 11);\n    i0.ɵɵtemplate(11, PlayerControlsComponent_div_3_p_11_Template, 2, 1, \"p\", 12);\n    i0.ɵɵtemplate(12, PlayerControlsComponent_div_3_ng_template_12_Template, 2, 0, \"ng-template\", null, 13, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"div\", 14);\n    i0.ɵɵtemplate(15, PlayerControlsComponent_div_3_h3_15_Template, 2, 2, \"h3\", 15);\n    i0.ɵɵtemplate(16, PlayerControlsComponent_div_3_h3_16_Template, 2, 2, \"h3\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 16)(18, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function PlayerControlsComponent_div_3_Template_button_click_18_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.play_previous_song());\n    });\n    i0.ɵɵelement(19, \"i\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function PlayerControlsComponent_div_3_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.togglePlayPause());\n    });\n    i0.ɵɵelement(21, \"i\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function PlayerControlsComponent_div_3_Template_button_click_22_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.play_next_song());\n    });\n    i0.ɵɵelement(23, \"i\", 21);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const _r3 = i0.ɵɵreference(13);\n    const ctx_r1 = i0.ɵɵnextContext();\n    const _r0 = i0.ɵɵreference(1);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", (ctx_r1.selectedSong == null ? null : ctx_r1.selectedSong.album == null ? null : ctx_r1.selectedSong.album.coverImage) || (ctx_r1.selectedSong == null ? null : ctx_r1.selectedSong.artist == null ? null : ctx_r1.selectedSong.artist.coverImage), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.formatTime((_r0 == null ? null : _r0.nativeElement == null ? null : _r0.nativeElement.currentTime) ? _r0.nativeElement.currentTime : 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", (_r0 == null ? null : _r0.nativeElement == null ? null : _r0.nativeElement.currentTime) / (_r0 == null ? null : _r0.nativeElement == null ? null : _r0.nativeElement.duration) * 100 || 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r0 == null ? null : _r0.nativeElement == null ? null : _r0.nativeElement.duration)(\"ngIfElse\", _r3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedSong == null ? null : ctx_r1.selectedSong.album == null ? null : ctx_r1.selectedSong.album.artist == null ? null : ctx_r1.selectedSong.album.artist.artistName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !(ctx_r1.selectedSong == null ? null : ctx_r1.selectedSong.album == null ? null : ctx_r1.selectedSong.album.artist == null ? null : ctx_r1.selectedSong.album.artist.artistName) && (ctx_r1.selectedSong == null ? null : ctx_r1.selectedSong.artist == null ? null : ctx_r1.selectedSong.artist.artistName));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.playIcon);\n  }\n}\nexport class PlayerControlsComponent {\n  constructor(mediaService) {\n    this.mediaService = mediaService;\n    this.songs = [];\n    this.playIcon = 'fa-play';\n    this.isPlaying = false;\n    this.pausedTime = 0; // Guarda el tiempo actual de la canción cuando se pausa\n  }\n\n  ngOnInit() {\n    this.setupAudioEvents();\n    this.currentSongSubscription = this.mediaService.currentSong$.subscribe(song => {\n      if (song) {\n        this.selectSong(song);\n      }\n    });\n  }\n  ngOnDestroy() {\n    this.pause(); // Pausar la canción cuando el componente se destruya\n    this.audioPlayer.nativeElement.removeEventListener('ended', this.handleEnded.bind(this));\n    this.audioPlayer.nativeElement.removeEventListener('timeupdate', this.handleTimeUpdate.bind(this));\n    clearInterval(this.progressInterval);\n  }\n  setupAudioEvents() {\n    this.audioPlayer.nativeElement.addEventListener('ended', this.handleEnded.bind(this));\n    this.audioPlayer.nativeElement.addEventListener('timeupdate', this.handleTimeUpdate.bind(this));\n  }\n  handleEnded() {\n    console.log('Canción actual terminada, reproduciendo la siguiente...');\n    this.play_next_song();\n  }\n  loadAudio(audioUrl) {\n    console.log('Cargando audio:', audioUrl);\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\n      this.audioPlayer.nativeElement.src = audioUrl;\n      this.audioPlayer.nativeElement.load();\n    }\n  }\n  onLoadedMetadata() {\n    console.log('Canción cargada completamente');\n    this.play();\n    this.printNextAndPreviousSongs();\n  }\n  play() {\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.play) {\n      if (this.pausedTime) {\n        this.audioPlayer.nativeElement.currentTime = this.pausedTime;\n        this.pausedTime = 0;\n      } else {\n        this.audioPlayer.nativeElement.currentTime = 0; // Reiniciar la posición de la canción si no se pausó previamente\n      }\n\n      this.audioPlayer.nativeElement.play();\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\n      this.isPlaying = true;\n      this.startProgressInterval();\n    }\n  }\n  pause() {\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.duration !== undefined) {\n      this.pausedTime = this.audioPlayer.nativeElement.currentTime; // Guarda el tiempo actual de la canción\n      this.audioPlayer.nativeElement.pause();\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\n      this.isPlaying = false;\n      clearInterval(this.progressInterval);\n    }\n  }\n  togglePlayPause() {\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\n      if (this.audioPlayer.nativeElement.paused) {\n        this.play(); // Reproducir la canción si estaba pausada\n      } else {\n        this.pause(); // Pausar la canción si se estaba reproduciendo\n      }\n    }\n  }\n\n  selectSong(song) {\n    this.pause(); // Pausar la canción actual\n    this.selectedSong = song;\n    this.loadAudio(song.audio);\n    this.printNextAndPreviousSongs();\n  }\n  printNextAndPreviousSongs() {\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\n      const currentIndex = this.songs.findIndex(song => song.id === this.selectedSong.id);\n      const previousIndex = (currentIndex - 1 + this.songs.length) % this.songs.length;\n      const nextIndex = (currentIndex + 1) % this.songs.length;\n      const previousSong = this.songs[previousIndex];\n      const nextSong = this.songs[nextIndex];\n      console.log('Canción actual:', this.selectedSong);\n      console.log('Canción anterior:', previousSong);\n      console.log('Siguiente canción:', nextSong);\n    }\n  }\n  play_next_song() {\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\n      this.pause(); // Pausar la canción actual\n      const currentIndex = this.songs.findIndex(song => song.id === this.selectedSong.id);\n      const nextIndex = (currentIndex + 1) % this.songs.length;\n      const nextSong = this.songs[nextIndex];\n      if (nextSong) {\n        console.log('Siguiente canción:', nextSong);\n        this.selectSong(nextSong);\n      } else {\n        console.log('¡La siguiente canción es indefinida!');\n      }\n    }\n  }\n  play_previous_song() {\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\n      this.pause(); // Pausar la canción actual\n      const currentIndex = this.songs.findIndex(song => song.id === this.selectedSong.id);\n      const previousIndex = (currentIndex - 1 + this.songs.length) % this.songs.length;\n      const previousSong = this.songs[previousIndex];\n      if (previousSong) {\n        console.log('Canción anterior:', previousSong);\n        this.selectSong(previousSong);\n      } else {\n        console.log('¡La canción anterior es indefinida!');\n      }\n    }\n  }\n  handleTimeUpdate(event) {\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\n      const progress = this.audioPlayer.nativeElement.currentTime / this.audioPlayer.nativeElement.duration * 100;\n      const progressBar = document.getElementById('progressBar');\n      if (progressBar) {\n        progressBar.value = progress.toString();\n      }\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\n      this.updateTimeDisplay(); // Actualizar la visualización de tiempo\n    }\n  }\n\n  updatePlayIcon() {\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\n      const isPlaying = !this.audioPlayer.nativeElement.paused;\n      const newPlayIcon = isPlaying ? 'fa-pause' : 'fa-play';\n      this.playIcon = newPlayIcon;\n      this.isPlaying = isPlaying;\n    }\n  }\n  updateTimeDisplay() {\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.currentTime !== undefined && this.audioPlayer.nativeElement.duration !== undefined) {\n      const timeLeft = document.querySelector('.time-left');\n      const timeRight = document.querySelector('.time-right');\n      if (timeLeft && timeRight) {\n        timeLeft.textContent = this.formatTime(this.audioPlayer.nativeElement.currentTime);\n        timeRight.textContent = this.formatTime(this.audioPlayer.nativeElement.duration);\n      }\n    }\n  }\n  handleProgressBar(event) {\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\n      const progress = event.target.value;\n      const duration = this.audioPlayer.nativeElement.duration;\n      if (!isNaN(duration) && isFinite(duration)) {\n        const newTime = duration * progress / 100;\n        if (!isNaN(newTime) && isFinite(newTime)) {\n          this.audioPlayer.nativeElement.currentTime = newTime;\n        }\n      }\n    }\n  }\n  formatTime(seconds) {\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = Math.floor(seconds % 60);\n    return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;\n  }\n  startProgressInterval() {\n    clearInterval(this.progressInterval);\n    this.progressInterval = setInterval(() => {\n      if (this.audioPlayer && this.audioPlayer.nativeElement) {\n        const progress = this.audioPlayer.nativeElement.currentTime / this.audioPlayer.nativeElement.duration * 100;\n        const progressBar = document.getElementById('progressBar');\n        if (progressBar) {\n          progressBar.value = progress.toString();\n        }\n      }\n    }, 1000);\n  }\n  static #_ = this.ɵfac = function PlayerControlsComponent_Factory(t) {\n    return new (t || PlayerControlsComponent)(i0.ɵɵdirectiveInject(i1.MediaService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PlayerControlsComponent,\n    selectors: [[\"app-player-controls\"]],\n    viewQuery: function PlayerControlsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.audioPlayer = _t.first);\n      }\n    },\n    inputs: {\n      selectedSong: \"selectedSong\",\n      songs: \"songs\"\n    },\n    decls: 4,\n    vars: 1,\n    consts: [[3, \"timeupdate\"], [\"audioPlayer\", \"\"], [\"class\", \"container1\", 4, \"ngIf\"], [1, \"container1\"], [1, \"media-container\"], [1, \"mediaDetails\"], [\"alt\", \"Media Cover\", 1, \"cover-image\", 3, \"src\"], [1, \"progress-container\"], [1, \"progress-style\"], [1, \"time-left\"], [\"id\", \"progressBar\", \"type\", \"range\", \"min\", \"0\", \"max\", \"100\", 1, \"form-range\", 3, \"value\", \"input\"], [1, \"time-right\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [1, \"song-info\"], [\"class\", \"title\", 4, \"ngIf\"], [1, \"controls\", \"mt-3\", \"player-button\"], [1, \"btn\", \"btn-primary\", \"skip-btn\", 3, \"click\"], [1, \"fas\", \"fa-backward\"], [1, \"btn\", \"btn-primary\", \"play-pause-btn\", 3, \"click\"], [1, \"fas\", 3, \"ngClass\"], [1, \"fas\", \"fa-forward\"], [1, \"title\"]],\n    template: function PlayerControlsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"audio\", 0, 1);\n        i0.ɵɵlistener(\"timeupdate\", function PlayerControlsComponent_Template_audio_timeupdate_0_listener($event) {\n          return ctx.handleTimeUpdate($event);\n        });\n        i0.ɵɵtext(2, \" Tu navegador no soporta el elemento de audio.\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, PlayerControlsComponent_div_3_Template, 24, 8, \"div\", 2);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedSong);\n      }\n    },\n    dependencies: [i2.NgClass, i2.NgIf],\n    styles: [\".container1[_ngcontent-%COMP%] {\\n    background-color: black;\\n    width: auto;\\n    height: 400px;\\n    width: 100%;\\n    font-family: 'Poppins', sans-serif;\\n    color: white;\\n    display: flex;\\n    flex-direction: column;\\n    padding-left: 50px;\\n    padding-right: 50px;\\n}\\n\\n.media-container[_ngcontent-%COMP%] {\\n    display: flex;\\n    flex-direction: column;\\n    align-items: flex-start; \\n    margin-bottom: 20px;\\n    padding-top: 10px;\\n}\\n\\n.mediaDetails[_ngcontent-%COMP%] {\\n    padding: 5px;\\n    border-radius: 10px;\\n}\\n\\n.cover-image[_ngcontent-%COMP%]{\\n    height: 150px;\\n    width: 150px;\\n    align-content: first baseline;\\n}\\n\\n.progress-container[_ngcontent-%COMP%] {\\n    width: 100%;\\n}\\n\\n.progress-style[_ngcontent-%COMP%] {\\n    display: flex;\\n    align-items: center;\\n}\\n\\n.time-left[_ngcontent-%COMP%], .time-right[_ngcontent-%COMP%] {\\n    font-size: 15px;\\n    text-align: left;\\n}\\n\\n.song-info[_ngcontent-%COMP%] {\\n    text-align: left; \\n    padding-top: 5px;\\n    font-family: 'Poppins', sans-serif;\\n}\\n\\n\\n.controls[_ngcontent-%COMP%] {\\n    display: flex;\\n    justify-content: center; \\n}\\n\\n\\n.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n    margin: 0 10px;\\n    font-size: 25px;\\n}\\n\\n.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\\n    font-size: 20px;\\n}\\n\\n.btn[_ngcontent-%COMP%]:focus {\\n    outline: none;\\n}\\n\\n.play-pause-btn[_ngcontent-%COMP%] {\\n    color: white;\\n    border-radius: 30px;\\n    background-color: blue;\\n    border: none;\\n    margin-right: 20px;\\n    height: 50px;\\n    width: 50px;\\n}\\n\\n.play-pause-btn[_ngcontent-%COMP%]:hover, .play-pause-btn[_ngcontent-%COMP%]:focus, .play-pause-btn[_ngcontent-%COMP%]:active {\\n    background-color: blue;\\n}\\n\\n.skip-btn[_ngcontent-%COMP%] {\\n    color: white;\\n    background-color: transparent;\\n    border: none;\\n    margin-right: 20px;\\n}\\n\\n.skip-btn[_ngcontent-%COMP%]:hover, .skip-btn[_ngcontent-%COMP%]:focus, .skip-btn[_ngcontent-%COMP%]:active {\\n    background-color: transparent;\\n    border: 1px solid white;\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvQ29tcG9uZW50cy9wbGF5ZXItY29udHJvbHMvcGxheWVyLWNvbnRyb2xzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSx1QkFBdUI7SUFDdkIsV0FBVztJQUNYLGFBQWE7SUFDYixXQUFXO0lBQ1gsa0NBQWtDO0lBQ2xDLFlBQVk7SUFDWixhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLGtCQUFrQjtJQUNsQixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLHVCQUF1QjtJQUN2QixtQkFBbUI7SUFDbkIsaUJBQWlCO0FBQ3JCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGFBQWE7SUFDYixZQUFZO0lBQ1osNkJBQTZCO0FBQ2pDOztBQUVBO0lBQ0ksV0FBVztBQUNmOztBQUVBO0lBQ0ksYUFBYTtJQUNiLG1CQUFtQjtBQUN2Qjs7QUFFQTs7SUFFSSxlQUFlO0lBQ2YsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksZ0JBQWdCO0lBQ2hCLGdCQUFnQjtJQUNoQixrQ0FBa0M7QUFDdEM7OztBQUdBO0lBQ0ksYUFBYTtJQUNiLHVCQUF1QjtBQUMzQjs7O0FBR0E7SUFDSSxjQUFjO0lBQ2QsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLGVBQWU7QUFDbkI7O0FBRUE7SUFDSSxhQUFhO0FBQ2pCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLG1CQUFtQjtJQUNuQixzQkFBc0I7SUFDdEIsWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixZQUFZO0lBQ1osV0FBVztBQUNmOztBQUVBOzs7SUFHSSxzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxZQUFZO0lBQ1osNkJBQTZCO0lBQzdCLFlBQVk7SUFDWixrQkFBa0I7QUFDdEI7O0FBRUE7OztJQUdJLDZCQUE2QjtJQUM3Qix1QkFBdUI7QUFDM0IiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyMSB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcclxuICAgIHdpZHRoOiBhdXRvO1xyXG4gICAgaGVpZ2h0OiA0MDBweDtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgcGFkZGluZy1sZWZ0OiA1MHB4O1xyXG4gICAgcGFkZGluZy1yaWdodDogNTBweDtcclxufVxyXG5cclxuLm1lZGlhLWNvbnRhaW5lciB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyBcclxuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcbiAgICBwYWRkaW5nLXRvcDogMTBweDtcclxufVxyXG5cclxuLm1lZGlhRGV0YWlscyB7XHJcbiAgICBwYWRkaW5nOiA1cHg7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG59XHJcblxyXG4uY292ZXItaW1hZ2V7XHJcbiAgICBoZWlnaHQ6IDE1MHB4O1xyXG4gICAgd2lkdGg6IDE1MHB4O1xyXG4gICAgYWxpZ24tY29udGVudDogZmlyc3QgYmFzZWxpbmU7XHJcbn1cclxuXHJcbi5wcm9ncmVzcy1jb250YWluZXIge1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5wcm9ncmVzcy1zdHlsZSB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5cclxuLnRpbWUtbGVmdCxcclxuLnRpbWUtcmlnaHQge1xyXG4gICAgZm9udC1zaXplOiAxNXB4O1xyXG4gICAgdGV4dC1hbGlnbjogbGVmdDtcclxufVxyXG5cclxuLnNvbmctaW5mbyB7XHJcbiAgICB0ZXh0LWFsaWduOiBsZWZ0OyBcclxuICAgIHBhZGRpbmctdG9wOiA1cHg7XHJcbiAgICBmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmO1xyXG59XHJcblxyXG5cclxuLmNvbnRyb2xzIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgXHJcbn1cclxuXHJcblxyXG4uY29udHJvbHMgYnV0dG9uIHtcclxuICAgIG1hcmdpbjogMCAxMHB4O1xyXG4gICAgZm9udC1zaXplOiAyNXB4O1xyXG59XHJcblxyXG4uYnRuIGkge1xyXG4gICAgZm9udC1zaXplOiAyMHB4O1xyXG59XHJcblxyXG4uYnRuOmZvY3VzIHtcclxuICAgIG91dGxpbmU6IG5vbmU7XHJcbn1cclxuXHJcbi5wbGF5LXBhdXNlLWJ0biB7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgICBib3JkZXItcmFkaXVzOiAzMHB4O1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogYmx1ZTtcclxuICAgIGJvcmRlcjogbm9uZTtcclxuICAgIG1hcmdpbi1yaWdodDogMjBweDtcclxuICAgIGhlaWdodDogNTBweDtcclxuICAgIHdpZHRoOiA1MHB4O1xyXG59XHJcblxyXG4ucGxheS1wYXVzZS1idG46aG92ZXIsXHJcbi5wbGF5LXBhdXNlLWJ0bjpmb2N1cyxcclxuLnBsYXktcGF1c2UtYnRuOmFjdGl2ZSB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibHVlO1xyXG59XHJcblxyXG4uc2tpcC1idG4ge1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgICBib3JkZXI6IG5vbmU7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7XHJcbn1cclxuXHJcbi5za2lwLWJ0bjpob3ZlcixcclxuLnNraXAtYnRuOmZvY3VzLFxyXG4uc2tpcC1idG46YWN0aXZlIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgd2hpdGU7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r2","formatTime","_r0","nativeElement","duration","ɵɵtextInterpolate2","ctx_r5","selectedSong","songTitle","album","artist","artistName","ctx_r6","title","ɵɵelement","ɵɵlistener","PlayerControlsComponent_div_3_Template_input_input_9_listener","$event","ɵɵrestoreView","_r8","ctx_r7","ɵɵnextContext","ɵɵresetView","handleProgressBar","ɵɵtemplate","PlayerControlsComponent_div_3_p_11_Template","PlayerControlsComponent_div_3_ng_template_12_Template","ɵɵtemplateRefExtractor","PlayerControlsComponent_div_3_h3_15_Template","PlayerControlsComponent_div_3_h3_16_Template","PlayerControlsComponent_div_3_Template_button_click_18_listener","ctx_r9","play_previous_song","PlayerControlsComponent_div_3_Template_button_click_20_listener","ctx_r10","togglePlayPause","PlayerControlsComponent_div_3_Template_button_click_22_listener","ctx_r11","play_next_song","ɵɵproperty","ctx_r1","coverImage","ɵɵsanitizeUrl","ɵɵtextInterpolate","currentTime","_r3","playIcon","PlayerControlsComponent","constructor","mediaService","songs","isPlaying","pausedTime","ngOnInit","setupAudioEvents","currentSongSubscription","currentSong$","subscribe","song","selectSong","ngOnDestroy","pause","audioPlayer","removeEventListener","handleEnded","bind","handleTimeUpdate","clearInterval","progressInterval","addEventListener","console","log","loadAudio","audioUrl","src","load","onLoadedMetadata","play","printNextAndPreviousSongs","updatePlayIcon","startProgressInterval","undefined","paused","audio","length","currentIndex","findIndex","id","previousIndex","nextIndex","previousSong","nextSong","event","progress","progressBar","document","getElementById","value","toString","updateTimeDisplay","newPlayIcon","timeLeft","querySelector","timeRight","textContent","target","isNaN","isFinite","newTime","seconds","minutes","Math","floor","remainingSeconds","setInterval","_","ɵɵdirectiveInject","i1","MediaService","_2","selectors","viewQuery","PlayerControlsComponent_Query","rf","ctx","PlayerControlsComponent_Template_audio_timeupdate_0_listener","PlayerControlsComponent_div_3_Template"],"sources":["C:\\Comercio\\version12\\musicsound\\front-end\\src\\app\\Components\\player-controls\\player-controls.component.ts","C:\\Comercio\\version12\\musicsound\\front-end\\src\\app\\Components\\player-controls\\player-controls.component.html"],"sourcesContent":["import {\r\n  Component,\r\n  OnInit,\r\n  OnDestroy,\r\n  ViewChild,\r\n  ElementRef,\r\n  Input,\r\n} from '@angular/core';\r\nimport { MediaService } from 'src/app/Services/player-control/media.service';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-player-controls',\r\n  templateUrl: './player-controls.component.html',\r\n  styleUrls: ['./player-controls.component.css'],\r\n})\r\nexport class PlayerControlsComponent implements OnInit, OnDestroy {\r\n  @ViewChild('audioPlayer', { static: true })\r\n  audioPlayer!: ElementRef<HTMLAudioElement>;\r\n\r\n  @Input() selectedSong: any;\r\n  @Input() songs: any[] = [];\r\n\r\n  currentSongSubscription: Subscription;\r\n  playIcon: string = 'fa-play';\r\n  isPlaying: boolean = false;\r\n  progressInterval: any;\r\n  pausedTime: number = 0; // Guarda el tiempo actual de la canción cuando se pausa\r\n\r\n  constructor(private mediaService: MediaService) {}\r\n\r\n  ngOnInit() {\r\n    this.setupAudioEvents();\r\n\r\n    this.currentSongSubscription = this.mediaService.currentSong$.subscribe(\r\n      (song) => {\r\n        if (song) {\r\n          this.selectSong(song);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.pause(); // Pausar la canción cuando el componente se destruya\r\n    this.audioPlayer.nativeElement.removeEventListener(\r\n      'ended',\r\n      this.handleEnded.bind(this)\r\n    );\r\n    this.audioPlayer.nativeElement.removeEventListener(\r\n      'timeupdate',\r\n      this.handleTimeUpdate.bind(this)\r\n    );\r\n    clearInterval(this.progressInterval);\r\n  }\r\n\r\n  setupAudioEvents() {\r\n    this.audioPlayer.nativeElement.addEventListener('ended', this.handleEnded.bind(this));\r\n    this.audioPlayer.nativeElement.addEventListener('timeupdate', this.handleTimeUpdate.bind(this));\r\n  }\r\n\r\n  handleEnded() {\r\n    console.log('Canción actual terminada, reproduciendo la siguiente...');\r\n    this.play_next_song();\r\n  }\r\n\r\n  loadAudio(audioUrl: string) {\r\n    console.log('Cargando audio:', audioUrl);\r\n  \r\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n      this.audioPlayer.nativeElement.src = audioUrl;\r\n      this.audioPlayer.nativeElement.load();\r\n    }\r\n  }\r\n\r\n  onLoadedMetadata() {\r\n    console.log('Canción cargada completamente');\r\n    this.play();\r\n    this.printNextAndPreviousSongs();\r\n  }\r\n\r\n  play() {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.play) {\r\n      if (this.pausedTime) {\r\n        this.audioPlayer.nativeElement.currentTime = this.pausedTime;\r\n        this.pausedTime = 0;\r\n      } else {\r\n        this.audioPlayer.nativeElement.currentTime = 0; // Reiniciar la posición de la canción si no se pausó previamente\r\n      }\r\n      this.audioPlayer.nativeElement.play();\r\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\r\n      this.isPlaying = true;\r\n      this.startProgressInterval();\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.duration !== undefined) {\r\n      this.pausedTime = this.audioPlayer.nativeElement.currentTime; // Guarda el tiempo actual de la canción\r\n      this.audioPlayer.nativeElement.pause();\r\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\r\n      this.isPlaying = false;\r\n      clearInterval(this.progressInterval);\r\n    }\r\n  }\r\n\r\n  togglePlayPause() {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n      if (this.audioPlayer.nativeElement.paused) {\r\n        this.play(); // Reproducir la canción si estaba pausada\r\n      } else {\r\n        this.pause(); // Pausar la canción si se estaba reproduciendo\r\n      }\r\n    }\r\n  }\r\n\r\n  selectSong(song: any) {\r\n    this.pause(); // Pausar la canción actual\r\n    this.selectedSong = song;\r\n    this.loadAudio(song.audio);\r\n    this.printNextAndPreviousSongs();\r\n  }\r\n  \r\n  printNextAndPreviousSongs() {\r\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\r\n      const currentIndex = this.songs.findIndex(\r\n        (song) => song.id === this.selectedSong.id\r\n      );\r\n\r\n      const previousIndex = (currentIndex - 1 + this.songs.length) % this.songs.length;\r\n      const nextIndex = (currentIndex + 1) % this.songs.length;\r\n\r\n      const previousSong = this.songs[previousIndex];\r\n      const nextSong = this.songs[nextIndex];\r\n\r\n      console.log('Canción actual:', this.selectedSong);\r\n      console.log('Canción anterior:', previousSong);\r\n      console.log('Siguiente canción:', nextSong);\r\n    }\r\n  }\r\n\r\n  play_next_song() {\r\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\r\n      this.pause(); // Pausar la canción actual\r\n      const currentIndex = this.songs.findIndex(\r\n        (song) => song.id === this.selectedSong.id\r\n      );\r\n      const nextIndex = (currentIndex + 1) % this.songs.length;\r\n      const nextSong = this.songs[nextIndex];\r\n      if (nextSong) {\r\n        console.log('Siguiente canción:', nextSong);\r\n        this.selectSong(nextSong);\r\n      } else {\r\n        console.log('¡La siguiente canción es indefinida!');\r\n      }\r\n    }\r\n  }\r\n  \r\n  play_previous_song() {\r\n    if (this.songs && this.songs.length > 0 && this.selectedSong) {\r\n      this.pause(); // Pausar la canción actual\r\n      const currentIndex = this.songs.findIndex(\r\n        (song) => song.id === this.selectedSong.id\r\n      );\r\n      const previousIndex = (currentIndex - 1 + this.songs.length) % this.songs.length;\r\n      const previousSong = this.songs[previousIndex];\r\n      if (previousSong) {\r\n        console.log('Canción anterior:', previousSong);\r\n        this.selectSong(previousSong);\r\n      } else {\r\n        console.log('¡La canción anterior es indefinida!');\r\n      }\r\n    }\r\n  }\r\n\r\n  handleTimeUpdate(event: any) {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n      const progress = (this.audioPlayer.nativeElement.currentTime / this.audioPlayer.nativeElement.duration) * 100;\r\n      const progressBar = document.getElementById('progressBar') as HTMLInputElement;\r\n      if (progressBar) {\r\n        progressBar.value = progress.toString();\r\n      }\r\n      this.updatePlayIcon(); // Actualizar el ícono de reproducción/pausa\r\n      this.updateTimeDisplay(); // Actualizar la visualización de tiempo\r\n    }\r\n  }\r\n\r\n  updatePlayIcon() {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n      const isPlaying = !this.audioPlayer.nativeElement.paused;\r\n      const newPlayIcon = isPlaying ? 'fa-pause' : 'fa-play';\r\n      this.playIcon = newPlayIcon;\r\n      this.isPlaying = isPlaying;\r\n    }\r\n  }\r\n\r\n  updateTimeDisplay() {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement && this.audioPlayer.nativeElement.currentTime !== undefined && this.audioPlayer.nativeElement.duration !== undefined) {\r\n      const timeLeft = document.querySelector('.time-left');\r\n      const timeRight = document.querySelector('.time-right');\r\n      if (timeLeft && timeRight) {\r\n        timeLeft.textContent = this.formatTime(this.audioPlayer.nativeElement.currentTime);\r\n        timeRight.textContent = this.formatTime(this.audioPlayer.nativeElement.duration);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleProgressBar(event: any) {\r\n    if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n      const progress = event.target.value;\r\n      const duration = this.audioPlayer.nativeElement.duration;\r\n\r\n      if (!isNaN(duration) && isFinite(duration)) {\r\n        const newTime = (duration * progress) / 100;\r\n        if (!isNaN(newTime) && isFinite(newTime)) {\r\n          this.audioPlayer.nativeElement.currentTime = newTime;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  formatTime(seconds: number): string {\r\n    const minutes = Math.floor(seconds / 60);\r\n    const remainingSeconds = Math.floor(seconds % 60);\r\n    return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;\r\n  }\r\n\r\n  startProgressInterval() {\r\n    clearInterval(this.progressInterval);\r\n    this.progressInterval = setInterval(() => {\r\n      if (this.audioPlayer && this.audioPlayer.nativeElement) {\r\n        const progress = (this.audioPlayer.nativeElement.currentTime / this.audioPlayer.nativeElement.duration) * 100;\r\n        const progressBar = document.getElementById('progressBar') as HTMLInputElement;\r\n        if (progressBar) {\r\n          progressBar.value = progress.toString();\r\n        }\r\n      }\r\n    }, 1000);\r\n  }\r\n}\r\n","<!-- Audio player element -->\r\n<audio #audioPlayer (timeupdate)=\"handleTimeUpdate($event)\">\r\n    Tu navegador no soporta el elemento de audio.\r\n</audio>\r\n\r\n<div class=\"container1\" *ngIf=\"selectedSong\">\r\n    <!-- Media cover -->\r\n    <div class=\"media-container\">\r\n        <div class=\"mediaDetails\">\r\n            <div>\r\n                <img [src]=\"selectedSong?.album?.coverImage || selectedSong?.artist?.coverImage\" alt=\"Media Cover\" class=\"cover-image\">\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Progress bar -->\r\n    <div class=\"progress-container\">\r\n        <div class=\"progress-style\">\r\n            <div class=\"time-left\">{{ formatTime(audioPlayer?.nativeElement?.currentTime ? audioPlayer.nativeElement.currentTime : 0) }}</div>\r\n            <input id=\"progressBar\" type=\"range\" class=\"form-range\" min=\"0\" max=\"100\" [value]=\"(audioPlayer?.nativeElement?.currentTime / audioPlayer?.nativeElement?.duration * 100) || 0\" (input)=\"handleProgressBar($event)\">\r\n            <div class=\"time-right\">\r\n                <p *ngIf=\"audioPlayer?.nativeElement?.duration; else elseBlock\">\r\n                    {{ formatTime(audioPlayer.nativeElement.duration) }}\r\n                </p>\r\n                <ng-template #elseBlock>\r\n                    <p>0:00</p>\r\n                </ng-template>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Song information -->\r\n    <div class=\"song-info\">\r\n        <h3 class=\"title\" *ngIf=\"selectedSong?.album?.artist?.artistName\">\r\n            {{ selectedSong?.songTitle }} - {{ selectedSong?.album?.artist?.artistName }}\r\n        </h3>\r\n        <h3 class=\"title\" *ngIf=\"!selectedSong?.album?.artist?.artistName && selectedSong?.artist?.artistName\">\r\n            {{ selectedSong?.title }} - {{ selectedSong?.artist?.artistName }}\r\n        </h3>\r\n    </div>\r\n\r\n    <!-- Player controls -->\r\n    <div class=\"controls mt-3 player-button\">\r\n        <button (click)=\"play_previous_song()\" class=\"btn btn-primary skip-btn\">\r\n            <i class=\"fas fa-backward\"></i>\r\n        </button>\r\n        <button (click)=\"togglePlayPause()\" class=\"btn btn-primary play-pause-btn\">\r\n            <i class=\"fas\" [ngClass]=\"playIcon\"></i>\r\n        </button>\r\n        <button (click)=\"play_next_song()\" class=\"btn btn-primary skip-btn\">\r\n            <i class=\"fas fa-forward\"></i>\r\n        </button>\r\n    </div>\r\n</div>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}